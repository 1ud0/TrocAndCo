<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<title>RECHERCHE OBJET</title>
</h:head>
<h:body bgcolor='white'>

	<f:metadata>
		<f:event listener="#{mbRecherche.loadingPage()}" type="preRenderView"></f:event>
	</f:metadata>

	<ui:composition template="/WEB-INF/templates/templateBase.xhtml">
	
		<ui:define name="headPerso">
		
		</ui:define>
		
		<ui:define name="content">

			<h:panelGroup layout="block" id="recherche">

				<!-- RESULTAT RECHERCHE DEBUT -->

				<div class="container">
					<div class="row">
						<!-- *** LEFT COLUMN ***
_________________________________________________________ -->
						<div class="row products">
						
							<h:form id="filterSeek">

							<div class="col-md-3 col-sm-3">

								<!-- *** MENUS AND FILTERS ***
_________________________________________________________ -->
							
							
								
								<!--Categorie du menu debut-->
								<div class="panel panel-default sidebar-menu">
									<div class="panel-heading">
										<h3 class="panel-title">
											<f:ajax render="recherche">
												<h:commandLink action="#{mbRecherche.listenerCat(null)}" value="Catégories" />
											</f:ajax>
										</h3>
									</div>
									<div  class="panel-body">
										<ul class="nav nav-pills nav-stacked category-menu">
											<f:ajax render="recherche">
												
												<ui:repeat var="entry" value="#{mbRecherche.catsEntries}">
													<li>
														<h:commandLink action="#{mbRecherche.listenerCat(entry.key)}" value="#{entry.key.intitule}" />
														<ul>
															<ui:repeat var="sousCat" value="#{entry.value}">
																<li>
																	<h:commandLink action="#{mbRecherche.listenerSousCat(sousCat)}" value="#{sousCat.intitule}">
																		<span class="badge pull-right"><h:outputText value="#{mbRecherche.getNbOccurence(sousCat)}" /></span>
																	</h:commandLink>
																</li>
															</ui:repeat>
														</ul>
													</li>
												</ui:repeat>
											</f:ajax>
										</ul>
									</div>
								</div>
								
								<!-- panel adresse -->
								<h:panelGroup styleClass="panel panel-default sidebar-menu" rendered="#{mbIdentif.membreConnected != null}">
									<div class="panel-heading">
										<h3 class="panel-title">Localisation</h3>
									</div>
									<div class="panel-body">
										<h5>Vos Adresses</h5>
											<div class="form-group">
												<h:selectManyCheckbox value="#{mbRecherche.critere.lieux}" styleClass="checkbox-inline" layout="pageDirection">
													<f:selectItems value="#{mbRecherche.adresses}" var="currentAdr" itemLabel="#{currentAdr.titreAdresse}" itemValue="#{currentAdr.idLocalisation}" />
												</h:selectManyCheckbox>
											</div>

									</div>
								</h:panelGroup>
								
								<!-- panel distance -->
								<h:panelGroup styleClass="panel panel-default sidebar-menu" rendered="#{mbIdentif.membreConnected != null}">
									
									<div class="panel-body">
										<h5>Distance</h5>
											<div class="form-group">
												<h:selectOneRadio value="#{mbRecherche.critere.distanceMax}" styleClass="radio-inline" layout="pageDirection">
													<f:selectItem itemLabel="5km" itemValue="5"/>
													<f:selectItem itemLabel="10km" itemValue="10"/>
													<f:selectItem itemLabel="25km" itemValue="25"/>
													<f:selectItem itemLabel="50km" itemValue="50"/>
													<f:selectItem itemLabel="Pas de filtre" itemValue="0"/>
												</h:selectOneRadio>
											</div>
											<h:commandButton action="#{mbRecherche.startSearching()}" id="btnLoc" styleClass="btn btn-default btn-sm btn-template-main" value="APPLIQUER" onclick="javascript:window.location='#recherche'">
												<f:ajax render="recherche" execute="@form"/>
											</h:commandButton>

									</div>
								</h:panelGroup>

								<!-- panel Valeur -->
								<div class="panel panel-default sidebar-menu">
									<div class="panel-heading">
										<h3 class="panel-title">
											Valeur <img src="img/custom/feuille orange.png" alt=""></img>
										</h3>
									</div>
									<div class="panel-body">
									
											<div class="form-group">
												<h:selectManyCheckbox value="#{mbRecherche.critere.valeurs}" styleClass="checkbox-inline" layout="pageDirection">
													<f:selectItems var="valeur" value="#{mbRecherche.valeurs}" itemLabel="#{valeur.valeur}" itemValue="#{valeur.idValeur}"/>
												</h:selectManyCheckbox>
											</div>
											<h:commandButton action="#{mbRecherche.startSearching()}" id="btnVal" styleClass="btn btn-default btn-sm btn-template-main" value="APPLIQUER" onclick="javascript:window.location='#recherche'">
												<f:ajax render="recherche" execute="@form"/>
											</h:commandButton>
											
											
									</div>
								</div>
								
								<!-- panel Etat -->
								<div class="panel panel-default sidebar-menu">
									<div class="panel-heading">
										<h3 class="panel-title">Etat d'usure</h3>
									</div>
									<div class="panel-body">
											<div class="form-group">
												<h:selectOneRadio value="#{mbRecherche.critere.etat}" styleClass="radio-inline" layout="pageDirection">
													<f:selectItems var="etat" value="#{mbRecherche.etats}" itemLabel="#{etat.intitule}" itemValue="#{etat.idEtat}" />
													<f:selectItem itemLabel="Tous" itemValue="0"/>
													<f:ajax render="recherche" execute="@this"/>
												</h:selectOneRadio>
											</div>
										
									</div>
								</div>
								
								<!-- bouton save envie-->
								<h:commandButton value="Enregistrer une envie"  onclick="$('#ModalEnregistrementEnvie').modal('show');" styleClass="btn btn-vert btn-lg">
									<f:ajax event="click" listener="#{mbRecherche.startSearching()}" render="formAddEnvie"></f:ajax>
								</h:commandButton>
								
							</div>
							
							<!-- /.col-md-3 -->

							<!-- *** LEFT COLUMN END *** -->
							<!--Categorie du menu fin-->


							<!--Resultat recherche DEBUT-->
							<h:commandButton action="#{mbRecherche.resetFilter()}" id="btnReset" styleClass="btn btn-default btn-sm btn-template-main pull-right" value="REINITIALISER LES FILTRES">
								<f:ajax render="recherche" execute="@form"/>
							</h:commandButton>
							</h:form>
							<h5 class="text">Résultat de la recherche : <h:outputText value="#{mbRecherche.propositions.size()}" /> objet<h:outputText value="s" rendered="#{mbRecherche.propositions.size() > 1}"/> trouvé<h:outputText value="s" rendered="#{mbRecherche.propositions.size() > 1}"/></h5>
							
							<br /> <br /> <br />
							
							
							<!-- products -->
							<div class=" col-md-9 col-sm-12 ">
							<h:form>
								<div class="row">
									<ui:repeat var="prop" value="#{mbRecherche.propositions}">
										
											<div class=" col-md-3 col-sm-9 ">
												
												<div class="product ">

													<h:commandLink action="#{mbObjet.loadProposition(prop)}"
														value="">
														<div class="image ">
															<img src="#{prop.photos.get(0).url}" alt=""
																class="img-responsive image1"></img>
														</div>
														<!-- /.image -->
														<div class="text">
															<h3>#{prop.intitule}</h3>
															<span class="glyphicon glyphicon-map-marker"
																aria-hidden="true"></span>
															<p class="text-muted">#{prop.localisations.get(0).ville} </p>
															<p class="price">
																#{prop.valeur.valeur} <img
																	src="img/custom/feuille orange.png" alt=""></img>
															</p>

														</div>
														<!-- /.text -->
													</h:commandLink>
												</div>
											</div>
										
									</ui:repeat>
								</div>
								</h:form>
							</div>
							<!-- /.products -->

						</div>


					</div>
					<!--Pagination resultat recherche DEBUT -->
					<div class="pages">
						<ul class="pagination">
							<li><a href="#">&#171;</a></li>
							<li class="active"><a href="#">1</a></li>
							<li><a href="#">2</a></li>
							<li><a href="#">&#187;</a></li>
						</ul>
					</div>
					<!--Pagination resultat recherche FIN -->

					<!--Resultat recherche FIN -->

				</div>
				<!-- FIN DU CORPS DE LA PAGE -->


			</h:panelGroup>


			<!-- Modal pour enregistrer une envie-->
			<div class="modal fade" id="ModalEnregistrementEnvie" role="dialog">
				<div class="modal-dialog">

					<!-- Modal content-->
					<div class="modal-content">
						<h:form id="formAddEnvie">
						<h:panelGroup id ="addEnvie">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal">x</button>
								<h4 class="modal-title">Enregistrer une envie:</h4>
							</div>
							<div class="modal-body">

								<div class="row ">

									<div class="col-sm-6 col-md-6 ">
										<h4>Description:</h4>
										<p>
											<label> Catégorie: </label> <label class="italic">
												blabla</label>
										</p>
										<p>
											<label> Sous-catégorie: </label> <label class="italic">
												blabla </label>
										</p>
										<p>
											<label> Etat d'usure: </label> <label class="italic">
												blabla </label>
										</p>
										<p class="price">
											<label> Valeur: </label><label class="italic"> 3</label> <img
												src="img/custom/feuille orange.png" alt=""></img>
										</p>
										<p>
											<label>Adresse: </label> <label class="italic">
												blabla </label>
										</p>
										<p>
											<label>Nom: </label> <input type="text"></input>
										</p>
									</div>
									<div class="col-sm-6 col-md-6 orientationCenter borderLeft">
										<h4>Ajouter à vos listes d'envies:</h4>
										<div>
											<div class="input-group" id="selecteur">
												<select id="lunch" class="selectpicker form-control"
													data-live-search="true" title="Choisir un objet">
													<option value="0"></option>
													<option value="1" id="list_rub" class="noir">Ma
														liste</option>
													<option value="2" id="list_rub" class="noir">Liste
														mamie</option>
													<option value="3" id="list_rub" class="noir">Liste
														papa</option>

												</select>
											</div>
											<button type="submit" class="btn btn-link">Créer une
												nouvelle Liste</button>
										</div>
										<div>
											<h:form>
												<p>
													<label>Nom de la liste: </label> <input type="text"></input>
												</p>
												<button type="submit" class="btn btn-custom btn-lg">Créer</button>
												<button type="button" class="btn btn-custom btn-lg">Annuler</button>

											</h:form>

										</div>
									</div>

								</div>
								<div class="modal-footer">
									<button type="submit" class="btn btn-vert btn-lg"
										data-dismiss="modal">Enregistrer</button>

									<button type="button" class="btn btn-vert btn-lg"
										data-dismiss="modal">Annuler</button>

								</div>

							</div>
							</h:panelGroup>
						</h:form>
					</div>

				</div>

			</div>
			<!-- FIN Modal pour enregistrer une envie-->




		</ui:define>
	</ui:composition>
</h:body>
</html>
