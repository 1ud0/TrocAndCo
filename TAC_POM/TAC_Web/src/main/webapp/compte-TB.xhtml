<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
	<title>COMPTE - MES MESSAGES</title>
</h:head>
<h:body bgcolor='white'>

	<ui:composition template="/WEB-INF/templates/templateCompte.xhtml">

		<ui:define name="headPerso">
			<f:metadata>
				<f:event listener="#{mbIdentif.securePage()}" type="preRenderView"></f:event>
			</f:metadata>
		</ui:define>

		<ui:define name="content">
			<!-- *** DEBUT DU CORPS DE LA PAGE *** ____________ -->

			<div id="content" class="clearfix">
				<div class="container">
					<div class="row">
						<!-- ***Je commence ici ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
						<div class="col-md-9 clearfix" id="customer-account">

							<div id="row">
								<div class="row">
									<div class="col-sm-6 col-md-6">
										<div class="heading">
											<h4 class="text-uppercase">Mes acquisitions</h4>
										</div>
										<div class="table-responsive">
											<table class="table table-hover">
												<thead>
													<tr>
														<th>Objet</th>
														<th>Statut</th>
													</tr>
												</thead>
												<tbody>
													<h:panelGroup>
														<ui:repeat var="echange"
															value="#{mbCompteTB.compteEchangeBean.echangeDuMembre}">
															<h:form>
																<h:commandLink
																	action="#{mbCompteTB.compteEchangeBean.echangeDuMembre(echange)}"
																	value="">
																	<tr>
																		<td>#{echange.proposition.intitule}</td>
																		<td><h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'annule'}">
																				<span class="label label-danger">Annulé</span>
																			</h:panelGroup> <h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'refus'}">
																				<span class="label label-warning">Refusé</span>
																			</h:panelGroup> <h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'en cours'}">
																				<span class="label label-info">En cours</span>
																			</h:panelGroup> <h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'effectue'}">
																				<span class="label label-success">Effectué</span>
																			</h:panelGroup></td>
																		<td><a href="compte-echanges.xhtml"
																			class="btn btn-template-main btn-sm">Voir</a></td>
																	</tr>
																</h:commandLink>
															</h:form>
														</ui:repeat>

													</h:panelGroup>

												</tbody>
											</table>
										</div>
									</div>
									<div class="col-sm-6 col-md-6">
										<div class="heading">
											<h4 class="text-uppercase">Mes dons</h4>
										</div>
										<div class="table-responsive">
											<table class="table table-hover">
												<thead>
													<tr>
														<th>Objet</th>
														<th>Statut</th>
													</tr>
												</thead>
												<tbody>
													<h:panelGroup>
														<ui:repeat var="echange"
															value="#{mbCompteTB.compteEchangeBean.donDuMembre}">
															<h:form>
																<h:commandLink
																	action="#{mbCompteTB.compteEchangeBean.donDuMembre(echange)}"
																	value="">
																	<tr>
																		<td>#{echange.proposition.intitule}</td>
																		<td><h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'annule'}">
																				<span class="label label-danger">Annulé</span>
																			</h:panelGroup> <h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'refus'}">
																				<span class="label label-warning">Refusé</span>
																			</h:panelGroup> <h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'en cours'}">
																				<span class="label label-info">En cours</span>
																			</h:panelGroup> <h:panelGroup
																				rendered="#{mbCompteTB.compteEchangeBean.statusEchange(echange) == 'effectue'}">
																				<span class="label label-success">Effectué</span>
																			</h:panelGroup></td>
																		<td><a href="compte-echanges.xhtml"
																			class="btn btn-template-main btn-sm">Voir</a></td>
																	</tr>
																</h:commandLink>
															</h:form>
														</ui:repeat>

													</h:panelGroup>

												</tbody>
											</table>
										</div>
									</div>
								</div>
								<div class="rox">
									<div class="col-sm-6 col-md-6 clearfix echanges">
										<div class="heading">
											<h4 class="text-uppercase">Mes messages</h4>
										</div>
										<div class="table-responsive mailbox-messages">
											<table class="table table-hover">
												<h:form>
												<ui:repeat var="discussion"
													value="#{mbMessage.LesVraiesDiscussions()}">
													<tbody>
													
														<tr
															class="#{mbMessage.dernierMessage(discussion).lu or mbMessage.dernierMessage(discussion).emetteur.idMembre==mbIdentif.membreConnected.idMembre ? 'lu' : '' }">
															<td class="mailbox-subject">#{discussion.proposition.intitule}</td>
															<td class="mailbox-subject"><h:commandLink
																value="#{mbMessage.debutDernierMessage(discussion)}"
																onclick="$('#sidebar_secondary').addClass('popup-box-on')">
																<f:ajax event="click"
																	listener="#{mbMessage.loadChat(discussion)}"
																	render="fenetreChat" /> </h:commandLink>
															</td>
															<td class="mailbox-attachment"></td>
															<td class="mailbox-date">#{mbMessage.depuisQuand(discussion)}</td>
														</tr>

													</tbody>
												</ui:repeat>
												</h:form>
											</table>
										</div>
									</div>

									<div class="col-sm-6 col-md-6 clearfix echanges">
										<div class="heading">
											<h4 class="text-uppercase">Mes rendez-vous à venir</h4>
										</div>
										<div class="table-responsive">
											<table class="table table-hover">
												<thead>
													<tr>
														<th>Commentaires</th>
														<th>Date</th>
													</tr>
												</thead>
												<tbody>
													<tr>
														<td>Autocollants McDonalds Monopoly</td>
														<td>01/06/2017</td>
														<td><a href="customer-order.html"
															class="btn btn-template-main btn-sm">Voir</a></td>
													</tr>
													<tr>
														<td>Machine à laver C'estBeauC'estBosh</td>
														<td>08/06/2017</td>
														<td><a href="customer-order.html"
															class="btn btn-template-main btn-sm">Voir</a></td>
													</tr>
													<tr>
														<td>Livre "Le babyfoot pour les nuls"</td>
														<td>22/06/2013</td>
														<td><a href="customer-order.html"
															class="btn btn-template-main btn-sm">Voir</a></td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
								</div>
								<div class="col-sm-12 col-md-12 clearfix echanges">
									<div class="heading">
										<h4 class="text-uppercase">Mes évaluations</h4>
									</div>
									<div class="table-responsive">
										<table class="table table-hover">
											<thead>
												<tr>
													<th>Intitulé</th>
													<th>Note et commentaire</th>
													<th>Qui ?</th>
												</tr>
											</thead>
											<tbody>
												<h:panelGroup>
													<ui:repeat var="eval"
														value="#{mbCompteTB.getEchangesQuandDonneur(mbCompteTB.membreCourant)}">
														<h:form>

															<tr>
																<td><a href="#">#{eval.proposition.intitule}</a></td>
																<td>
																	<div class="col-sm-9">
																		<div class="review-block-rate">
																			<h:panelGroup rendered="#{eval.noteChercheur ge 1}">
																				<span class="glyphicon glyphicon-star"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur lt 1}">
																				<span class="glyphicon glyphicon-star-empty"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur ge 2}">
																				<span class="glyphicon glyphicon-star"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur lt 2}">
																				<span class="glyphicon glyphicon-star-empty"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur ge 3}">
																				<span class="glyphicon glyphicon-star"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur lt 3}">
																				<span class="glyphicon glyphicon-star-empty"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur ge 4}">
																				<span class="glyphicon glyphicon-star"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur lt 4}">
																				<span class="glyphicon glyphicon-star-empty"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur ge 5}">
																				<span class="glyphicon glyphicon-star"></span>
																			</h:panelGroup>
																			<h:panelGroup rendered="#{eval.noteChercheur lt 5}">
																				<span class="glyphicon glyphicon-star-empty"></span>
																			</h:panelGroup>
																		</div>
																		<br />
																		<div class="review-block-description">#{eval.comDonneur}</div>
																	</div>
																</td>
																<td class="imageAvatarSize"><img
																	class="img-responsive img-circle"
																	src="#{eval.membre.avatar}" alt=""></img></td>
																<td><a href="compte-evaluations.xhtml"
																	class="btn btn-template-main btn-sm">Voir</a></td>
															</tr>

														</h:form>
													</ui:repeat>
												</h:panelGroup>
											</tbody>
										</table>
									</div>
								</div>
							</div>

						</div>
						<!-- ***Je finis la ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////-->
						<!-- /caroussel -->

						<div class="container">
							<div class="col-sm-12 col-md-9">
								<h3>Des suggestions pour vos envies ?</h3>
								<div class="row dernieresEntrees">

									<ui:repeat var="prop" value="#{mbCompteTB.propositions}">
										<div class="col-sm-3">
											<div class="article">
												<div class="photo">
													<h:graphicImage
														value="#{prop.photos.size() > 0 ? prop.photos.get(0).url : 'img/camera-flat.png'}"
														styleClass="img-responsive" />
												</div>
												<div class="texteArticle">
													<span class="categorie"><h:outputText
															value="#{prop.intitule}" /> </span> <span class="nomArticle"><h:outputText
															value="#{prop.description}" /></span>
												</div>
											</div>
										</div>
									</ui:repeat>

								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			
		</ui:define>
	</ui:composition>
</h:body>
</html>
